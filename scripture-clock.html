<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scripture Clock</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Georgia, serif;
            color: white;
            overflow: hidden;
            height: 100vh;
        }
        
        /* Setup Screen */
        #setup-screen {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100vh;
            padding: 40px;
            overflow-y: auto;
        }
        
        .setup-container {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 50px;
            border-radius: 20px;
            max-width: 700px;
            width: 100%;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
            margin: 20px;
        }
        
        .setup-container h1 {
            font-size: 42px;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .setup-container .subtitle {
            font-size: 18px;
            margin-bottom: 40px;
            opacity: 0.9;
        }
        
        .setup-section {
            margin-bottom: 35px;
            text-align: left;
        }
        
        .setup-section h2 {
            font-size: 24px;
            margin-bottom: 15px;
            color: #ffd700;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        .option-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .option-btn {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 15px 20px;
            font-size: 18px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-family: Georgia, serif;
        }
        
        .option-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }
        
        .option-btn.selected {
            background: rgba(255,215,0,0.4);
            border-color: #ffd700;
            box-shadow: 0 0 20px rgba(255,215,0,0.5);
        }
        
        select {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            border-radius: 10px;
            border: 2px solid rgba(255,255,255,0.3);
            background: rgba(255,255,255,0.2);
            color: white;
            font-family: Georgia, serif;
            cursor: pointer;
        }
        
        select option {
            background: #764ba2;
            color: white;
        }
        
        .start-btn {
            background: #ffd700;
            color: #764ba2;
            border: none;
            padding: 20px 60px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s;
            font-family: Georgia, serif;
        }
        
        .start-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        /* Main Display */
        #main-display {
            display: none;
            height: 100vh;
            flex-direction: column;
        }
        
        .bg-advent { background: linear-gradient(135deg, #4a148c 0%, #1a237e 100%); }
        .bg-christmas { background: linear-gradient(135deg, #b71c1c 0%, #1b5e20 100%); }
        .bg-epiphany { background: linear-gradient(135deg, #f57f17 0%, #e65100 100%); }
        .bg-lent { background: linear-gradient(135deg, #4e342e 0%, #3e2723 100%); }
        .bg-easter { background: linear-gradient(135deg, #fff9c4 0%, #ffd700 100%); color: #333; }
        .bg-pentecost { background: linear-gradient(135deg, #c62828 0%, #d32f2f 100%); }
        .bg-ordinary { background: linear-gradient(135deg, #2e7d32 0%, #1b5e20 100%); }
        
        #datetime {
            position: fixed;
            top: 40px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: rgba(0,0,0,0.3);
            padding: 20px 40px;
            border-radius: 10px;
            z-index: 1000;
        }
        
        .date-line {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .time-line {
            font-size: 56px;
            font-weight: bold;
        }
        
        #liturgical-info {
            position: fixed;
            top: 20px;
            left: 20px;
            font-size: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            background: rgba(0,0,0,0.3);
            padding: 15px 25px;
            border-radius: 10px;
            z-index: 1000;
            text-align: left;
        }
        
        .season-name {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .day-name {
            font-size: 18px;
            opacity: 0.9;
        }
        
        #content {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 200px 40px 80px 40px;
            text-align: center;
        }
        
        .verse-container {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 80px;
            border-radius: 20px;
            max-width: 1800px;
            width: 90%;
            margin: 0 auto;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        .passage-title {
            font-size: 44px;
            font-weight: bold;
            color: #ffd700;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        .verse {
            font-size: 48px;
            line-height: 1.8;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        
        .reference {
            font-size: 40px;
            font-weight: bold;
            font-style: italic;
            color: #ffd700;
            margin-top: 30px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        /* Live Stream Notification */
        #live-stream-banner {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #c62828 0%, #d32f2f 100%);
            padding: 20px;
            text-align: center;
            transform: translateY(100%);
            transition: transform 0.5s;
            z-index: 2000;
        }
        
        #live-stream-banner.active {
            transform: translateY(0);
        }
        
        .live-badge {
            display: inline-block;
            background: #ff0000;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-weight: bold;
            margin-right: 15px;
            animation: pulse 2s infinite;
        }
        
        .stream-title {
            font-size: 24px;
            margin: 10px 0;
            font-weight: bold;
        }
        
        .watch-btn {
            background: white;
            color: #c62828;
            border: none;
            padding: 15px 40px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
            transition: all 0.3s;
            font-family: Georgia, serif;
        }
        
        .watch-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 16px rgba(0,0,0,0.3);
        }
        
        #settings-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.3);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 10px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            z-index: 1000;
            font-family: Georgia, serif;
            opacity: 0.6;
            transition: opacity 0.3s;
        }
        
        #settings-btn:hover {
            background: rgba(0,0,0,0.5);
            opacity: 1;
        }
        
        #audio-indicator {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: rgba(0,0,0,0.5);
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 16px;
            display: none;
            z-index: 1000;
        }
        
        .speaking {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }
        
        footer {
            position: fixed;
            bottom: 10px;
            left: 10px;
            font-size: 14px;
            opacity: 0.6;
            z-index: 1000;
            transition: opacity 0.3s;
        }
        
        footer:hover {
            opacity: 1;
        }
        
        footer a {
            color: #ffd700;
            text-decoration: none;
        }
        
        #about-link {
            position: fixed;
            bottom: 10px;
            right: 90px;
            font-size: 14px;
            opacity: 0.6;
            z-index: 1000;
            transition: opacity 0.3s;
        }
        
        #about-link:hover {
            opacity: 1;
        }
        
        #about-link a {
            color: #ffd700;
            text-decoration: none;
        }
        
        /* Easter season text color adjustment */
        .bg-easter .verse-container,
        .bg-easter #datetime,
        .bg-easter #liturgical-info,
        .bg-easter #audio-indicator {
            color: #333;
        }
        
        .bg-easter .passage-title,
        .bg-easter .reference {
            color: #b8860b;
        }
        /* Settings Panel */
#settings-panel {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 5000;
}

.settings-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.7);
}

.settings-container {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    color: #1d1d1f;
    padding: 40px;
    border-radius: 20px;
    max-width: 500px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.5);
}

.settings-container h2 {
    color: #667eea;
    margin-bottom: 30px;
    text-align: center;
}

.setting-item {
    margin-bottom: 25px;
    padding-bottom: 25px;
    border-bottom: 1px solid #e0e0e0;
}

.setting-item:last-of-type {
    border-bottom: none;
}

.setting-item label {
    display: block;
    font-weight: 600;
    margin-bottom: 10px;
    color: #1d1d1f;
}

.setting-item input[type="checkbox"] {
    margin-right: 10px;
    width: 18px;
    height: 18px;
    cursor: pointer;
}

.setting-item select {
    width: 100%;
    padding: 10px;
    border: 1px solid #d0d0d0;
    border-radius: 8px;
    font-size: 16px;
    color: #1d1d1f;
    background: white;
}

.setting-help {
    font-size: 14px;
    color: #666;
    margin-top: 5px;
}

.prayer-times-grid {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    margin-top: 10px;
}

.prayer-times-grid label {
    font-weight: normal;
    display: flex;
    align-items: center;
}

.setting-actions {
    margin-top: 30px;
    display: flex;
    gap: 15px;
}

.save-btn, .cancel-btn {
    flex: 1;
    padding: 15px;
    border: none;
    border-radius: 10px;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.save-btn {
    background: #667eea;
    color: white;
}

.save-btn:hover {
    background: #5568d3;
}

.cancel-btn {
    background: #e0e0e0;
    color: #1d1d1f;
}

.cancel-btn:hover {
    background: #d0d0d0;
}
        #prayer-notification {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 3000;
    animation: slideUp 0.5s ease-out;
}

.prayer-banner {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 30px;
    text-align: center;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
}

.prayer-banner h2 {
    font-size: 32px;
    margin-bottom: 10px;
}

.prayer-banner p {
    font-size: 20px;
}

@keyframes slideUp {
    from { transform: translateY(100%); }
    to { transform: translateY(0); }
}
        /* Dark Theme */
#main-display.dark-theme {
    background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
}

#main-display.dark-theme .verse-container {
    background: rgba(255,255,255,0.08);
}

#main-display.dark-theme #datetime,
#main-display.dark-theme #liturgical-info {
    background: rgba(0,0,0,0.5);
}

        
    </style>
</head>
<body>
    <!-- Setup Screen -->
    <div id="setup-screen">
        <div class="setup-container">
            <h1>‚è∞ Scripture Clock</h1>
            <p class="subtitle">Time with the Word</p>
            
            <!-- Language Selection -->
            <div class="setup-section">
                <h2>üåç Language / Idioma / Langue / L√≠ngua</h2>
                <div class="option-buttons">
                    <button class="option-btn selected" data-setting="language" data-value="en">English</button>
                    <button class="option-btn" data-setting="language" data-value="fr">Fran√ßais</button>
                    <button class="option-btn" data-setting="language" data-value="es">Espa√±ol</button>
                    <button class="option-btn" data-setting="language" data-value="pt">Portugu√™s</button>
                </div>
            </div>
            
            <!-- Bible Source -->
            <div class="setup-section">
                <h2>üìñ Bible Source</h2>
                <div class="option-buttons">
                    <button class="option-btn selected" data-setting="bibleSource" data-value="bible.com">Bible.com</button>
                    <button class="option-btn" data-setting="bibleSource" data-value="local">Offline Bible</button>
                </div>
            </div>
            
            <!-- Church Selection -->
            <div class="setup-section">
                <h2>‚õ™ Select Your Church</h2>
                <p style="font-size: 16px; opacity: 0.8; margin-bottom: 15px;">
                    Choose your church to receive live stream notifications, or select "Offline Mode" to use without a church.
                </p>
                <select id="church-select">
                    <option value="">Loading churches...</option>
                </select>
            </div>
            
            <!-- Liturgical Tradition -->
            <div class="setup-section">
                <h2>‚úùÔ∏è Liturgical Tradition</h2>
                <div class="option-buttons">
                    <button class="option-btn selected" data-setting="tradition" data-value="protestant">Protestant</button>
                    <button class="option-btn" data-setting="tradition" data-value="catholic">Catholic</button>
                    <button class="option-btn" data-setting="tradition" data-value="orthodox">Orthodox</button>
                </div>
            </div>
            
            <button class="start-btn" onclick="startDisplay()">Begin Display</button>
        </div>
    </div>

    <!-- Main Display -->
    <div id="main-display">
        <button id="settings-btn" onclick="openSettingsPanel()">‚öôÔ∏è <span id="settings-text">Settings</span></button>
        <div id="liturgical-info">
            <div class="season-name"></div>
            <div class="day-name"></div>
        </div>
        <div id="datetime">
            <div class="date-line" id="date-display"></div>
            <div class="time-line" id="time-display"></div>
        </div>
        <div id="prayer-notification" style="display: none;">
    <div class="prayer-banner">
        <h2>üôè Prayer Time</h2>
        <p id="prayer-message"></p>
    </div>
</div>
        <div id="content">
            <div class="verse-container" id="verses"></div>
        </div>
        <div id="audio-indicator">üîä <span id="speaking-text">Speaking...</span></div>
        
        <!-- Live Stream Banner -->
        <div id="live-stream-banner">
            <span class="live-badge">üî¥ LIVE</span>
            <div class="stream-title" id="stream-title"></div>
            <button class="watch-btn" onclick="watchLiveStream()"><span id="watch-text">Watch Now</span></button>
        </div>
        
        <footer>
            <a href="mailto:feedback@scriptureclock.io">üí¨ Feedback & Suggestions</a>
        </footer>
        
        <div id="about-link">
            <a href="about.html">‚ÑπÔ∏è About Us</a>
        </div>
    </div>
    <!-- Settings Panel Modal -->
<div id="settings-panel" style="display: none;">
    <div class="settings-overlay" onclick="closeSettingsPanel()"></div>
    <div class="settings-container">
        <h2>‚öôÔ∏è Settings</h2>
        
        <div class="setting-item">
            <label>
                <input type="checkbox" id="audio-toggle" checked>
                üîä Enable Audio Playback
            </label>
            <p class="setting-help">Play scripture verses aloud during permitted hours</p>
        </div>
        
        <div class="setting-item">
            <label>
                <input type="checkbox" id="live-toggle" checked>
                üì∫ Enable Live Streams
            </label>
            <p class="setting-help">Show live stream notifications when available</p>
        </div>
        
        <div class="setting-item">
            <label>Dark Mode</label>
            <select id="theme-select">
                <option value="auto">Auto (8 PM - 6 AM)</option>
                <option value="light">Always Light</option>
                <option value="dark">Always Dark</option>
            </select>
        </div>
        
        <div class="setting-item">
            <label>Prayer Times</label>
            <div class="prayer-times-grid">
                <label><input type="checkbox" class="prayer-hour" value="6"> 6 AM</label>
                <label><input type="checkbox" class="prayer-hour" value="7"> 7 AM</label>
                <label><input type="checkbox" class="prayer-hour" value="12"> 12 PM</label>
                <label><input type="checkbox" class="prayer-hour" value="18"> 6 PM</label>
                <label><input type="checkbox" class="prayer-hour" value="21"> 9 PM</label>
            </div>
            <p class="setting-help">Get prayer reminders at selected hours</p>
        </div>
        
        <div class="setting-actions">
            <button onclick="saveSettings()" class="save-btn">Save Settings</button>
            <button onclick="closeSettingsPanel()" class="cancel-btn">Cancel</button>
        </div>
    </div>
</div>

    <script>
        // Configuration
        let config = {
            language: 'en',
            bibleSource: 'bible.com',
            church: null,
            tradition: 'protestant'
        };
        
        let churches = [];
        let currentLiveStream = null;

        const LIVE_FEEDS = {};
        const CHURCH_FEEDS = {};
        const LECTIONARY_FEEDS = {};
        const LITURGIC_EVENT_FEEDS = {};
        const LIVE_FEED_RESTRICTIONS = { restricted: [1, 2, 3, 4, 5] };
        const AUDIO_PERMISSIONS = { allowed: [6, 7, 17, 18, 19, 20] };
        
        // Translations
        const translations = {
            en: {
                settings: 'Settings',
                speaking: 'Speaking...',
                watch: 'Watch Now',
                advent: 'Advent',
                christmas: 'Christmas',
                epiphany: 'Epiphany',
                lent: 'Lent',
                easter: 'Easter',
                pentecost: 'Pentecost',
                ordinaryTime: 'Ordinary Time'
            },
            fr: {
                settings: 'Param√®tres',
                speaking: 'En cours...',
                watch: 'Regarder',
                advent: 'Avent',
                christmas: 'No√´l',
                epiphany: '√âpiphanie',
                lent: 'Car√™me',
                easter: 'P√¢ques',
                pentecost: 'Pentec√¥te',
                ordinaryTime: 'Temps Ordinaire'
            },
            es: {
                settings: 'Configuraci√≥n',
                speaking: 'Hablando...',
                watch: 'Ver Ahora',
                advent: 'Adviento',
                christmas: 'Navidad',
                epiphany: 'Epifan√≠a',
                lent: 'Cuaresma',
                easter: 'Pascua',
                pentecost: 'Pentecost√©s',
                ordinaryTime: 'Tiempo Ordinario'
            },
            pt: {
                settings: 'Configura√ß√µes',
                speaking: 'Falando...',
                watch: 'Assistir Agora',
                advent: 'Advento',
                christmas: 'Natal',
                epiphany: 'Epifania',
                lent: 'Quaresma',
                easter: 'P√°scoa',
                pentecost: 'Pentecostes',
                ordinaryTime: 'Tempo Comum'
            }
        };


        
        // Setup screen handling
        document.querySelectorAll('.option-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const setting = this.dataset.setting;
                const value = this.dataset.value;
                
                // Deselect siblings
                this.parentElement.querySelectorAll('.option-btn').forEach(b => b.classList.remove('selected'));
                this.classList.add('selected');
                
                config[setting] = value;
                
                // Update UI language if language changed
                if (setting === 'language') {
                    updateUILanguage();
                }
            });
        });
        
        function updateUILanguage() {
            const lang = config.language;
            document.getElementById('settings-text').textContent = translations[lang].settings;
            document.getElementById('speaking-text').textContent = translations[lang].speaking;
            document.getElementById('watch-text').textContent = translations[lang].watch;
        }
        
        // Load churches from JSON
        async function loadChurches() {
            try {
                // Try to fetch from external JSON file
                const response = await fetch('churches_database.json');
                const data = await response.json();
                churches = data.churches;
                populateChurchDropdown();
                
            } catch (error) {
                console.error('Error loading churches:', error);
                // Fallback to embedded church data for testing
                churches = [
                    {
                        id: "church001",
                        name: "Grace Community Church",
                        location: "Johannesburg, South Africa",
                        timezone: "Africa/Johannesburg",
                        tradition: "protestant",
                        pastor: "Pastor John Smith",
                        contact: "pastor@gracechurch.example",
                        liveStream: {
                            isActive: false,
                            url: "",
                            title: "",
                            startTime: "",
                            endTime: "",
                            schedule: []
                        }
                    },
                    {
                        id: "church002",
                        name: "Igreja Batista Central",
                        location: "S√£o Paulo, Brasil",
                        timezone: "America/Sao_Paulo",
                        tradition: "protestant",
                        pastor: "Pastor Carlos Silva",
                        contact: "pastor@igrejabatista.example",
                        liveStream: {
                            isActive: false,
                            url: "",
                            title: "",
                            startTime: "",
                            endTime: "",
                            schedule: []
                        }
                    },
                    {
                        id: "church003",
                        name: "√âglise √âvang√©lique de Paris",
                        location: "Paris, France",
                        timezone: "Europe/Paris",
                        tradition: "protestant",
                        pastor: "Pasteur Marie Dubois",
                        contact: "pasteur@egliseparis.example",
                        liveStream: {
                            isActive: false,
                            url: "",
                            title: "",
                            startTime: "",
                            endTime: "",
                            schedule: []
                        }
                    },
                    {
                        id: "church004",
                        name: "Iglesia Cristiana Esperanza",
                        location: "Madrid, Espa√±a",
                        timezone: "Europe/Madrid",
                        tradition: "catholic",
                        pastor: "Padre Miguel Garc√≠a",
                        contact: "padre@iglesiaesperanza.example",
                        liveStream: {
                            isActive: false,
                            url: "",
                            title: "",
                            startTime: "",
                            endTime: "",
                            schedule: []
                        }
                    }
                ];
                populateChurchDropdown();
            }
        }
        
        function populateChurchDropdown() {
            const select = document.getElementById('church-select');
            select.innerHTML = '<option value="">-- Select your church --</option>';
            
            // Add "None / Offline Mode" option
            const offlineOption = document.createElement('option');
            offlineOption.value = 'offline';
            offlineOption.textContent = 'üè† None - Offline Mode (No live streams)';
            select.appendChild(offlineOption);
            
            // Add separator
            const separator = document.createElement('option');
            separator.disabled = true;
            separator.textContent = '‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ';
            select.appendChild(separator);
            
            churches.forEach(church => {
                const option = document.createElement('option');
                option.value = church.id;
                option.textContent = `${church.name} (${church.location})`;
                select.appendChild(option);
            });
            
            select.addEventListener('change', function() {
                config.church = this.value;
            });
        }
        
        function startDisplay() {
            if (!config.church) {
                alert('Please select your church or choose "Offline Mode"');
                return;
            }
            
            // Save preferences
            localStorage.setItem('bibleDisplayConfig', JSON.stringify(config));
            
            // Switch screens
            document.getElementById('setup-screen').style.display = 'none';
            document.getElementById('main-display').style.display = 'flex';
            
            // Initialize display
            updateUILanguage();
            initializeDisplay();
        }
        
        function showSetup() {
            document.getElementById('main-display').style.display = 'none';
            document.getElementById('setup-screen').style.display = 'flex';
        }
        
        // Check for live streams
        async function checkLiveStreams() {
            // Skip if in offline mode
            if (config.church === 'offline') {
                hideLiveStreamBanner();
                return;
            }
            
            try {
                const response = await fetch('churches_database.json');
                const data = await response.json();
                const myChurch = data.churches.find(c => c.id === config.church);
                
                if (myChurch && myChurch.liveStream && myChurch.liveStream.isActive) {
                    currentLiveStream = myChurch.liveStream;
                    showLiveStreamBanner();
                } else {
                    hideLiveStreamBanner();
                }
            } catch (error) {
                console.error('Error checking live streams:', error);
                hideLiveStreamBanner();
            }
        }
        
        function showLiveStreamBanner() {
            document.getElementById('stream-title').textContent = currentLiveStream.title;
            document.getElementById('live-stream-banner').classList.add('active');
        }
        
        function hideLiveStreamBanner() {
            document.getElementById('live-stream-banner').classList.remove('active');
            currentLiveStream = null;
        }
        
        function watchLiveStream() {
            if (currentLiveStream && currentLiveStream.url) {
                window.open(currentLiveStream.url, '_blank');
            }
        }
        
        // Easter calculation (Computus algorithm)
        function calculateEaster(year) {
            const a = year % 19;
            const b = Math.floor(year / 100);
            const c = year % 100;
            const d = Math.floor(b / 4);
            const e = b % 4;
            const f = Math.floor((b + 8) / 25);
            const g = Math.floor((b - f + 1) / 3);
            const h = (19 * a + b - d - g + 15) % 30;
            const i = Math.floor(c / 4);
            const k = c % 4;
            const l = (32 + 2 * e + 2 * i - h - k) % 7;
            const m = Math.floor((a + 11 * h + 22 * l) / 451);
            const month = Math.floor((h + l - 7 * m + 114) / 31);
            const day = ((h + l - 7 * m + 114) % 31) + 1;
            
            return new Date(year, month - 1, day);
        }
        
        // Calculate liturgical dates
        function getLiturgicalDates(year) {
            const easter = calculateEaster(year);
            const dates = {
                easter: easter,
                ashWednesday: new Date(easter.getTime() - 46 * 24 * 60 * 60 * 1000),
                palmSunday: new Date(easter.getTime() - 7 * 24 * 60 * 60 * 1000),
                maundyThursday: new Date(easter.getTime() - 3 * 24 * 60 * 60 * 1000),
                goodFriday: new Date(easter.getTime() - 2 * 24 * 60 * 60 * 1000),
                ascension: new Date(easter.getTime() + 39 * 24 * 60 * 60 * 1000),
                pentecost: new Date(easter.getTime() + 49 * 24 * 60 * 60 * 1000),
                trinitySunday: new Date(easter.getTime() + 56 * 24 * 60 * 60 * 1000),
                christmas: new Date(year, 11, 25),
                epiphany: new Date(year, 0, 6)
            };
            
            // First Sunday of Advent
            const christmas = new Date(year, 11, 25);
            const christmasDay = christmas.getDay();
            const daysToSunday = christmasDay === 0 ? 0 : 7 - christmasDay;
            dates.adventStart = new Date(year, 11, 25 - daysToSunday - 21);
            
            return dates;
        }
        
        // Determine liturgical season
        function getLiturgicalInfo(date) {
            const year = date.getFullYear();
            const dates = getLiturgicalDates(year);
            const prevDates = getLiturgicalDates(year - 1);
            
            const lang = config.language || 'en';
            const t = translations[lang];
            
            // Check special days
            if (isSameDay(date, dates.christmas)) {
                return { season: t.christmas, day: 'Christmas Day', bg: 'bg-christmas' };
            }
            if (isSameDay(date, dates.easter)) {
                return { season: t.easter, day: 'Easter Sunday', bg: 'bg-easter' };
            }
            if (isSameDay(date, dates.ashWednesday)) {
                return { season: t.lent, day: 'Ash Wednesday', bg: 'bg-lent' };
            }
            if (isSameDay(date, dates.pentecost)) {
                return { season: t.pentecost, day: 'Pentecost Sunday', bg: 'bg-pentecost' };
            }
            
            // Check seasons
            const currentAdvent = date >= dates.adventStart ? dates.adventStart : prevDates.adventStart;
            const adventEnd = date >= dates.adventStart ? dates.christmas : prevDates.christmas;
            if (date >= currentAdvent && date < adventEnd) {
                return { season: t.advent, day: 'Advent', bg: 'bg-advent' };
            }
            
            if (date >= dates.christmas && date < dates.epiphany) {
                return { season: t.christmas, day: 'Christmas Season', bg: 'bg-christmas' };
            }
            
            if (date >= dates.epiphany && date < dates.ashWednesday) {
                return { season: t.epiphany, day: 'Epiphany Season', bg: 'bg-epiphany' };
            }
            
            if (date >= dates.ashWednesday && date < dates.easter) {
                return { season: t.lent, day: 'Lenten Season', bg: 'bg-lent' };
            }
            
            const easterEnd = new Date(dates.pentecost.getTime() + 1 * 24 * 60 * 60 * 1000);
            if (date >= dates.easter && date < easterEnd) {
                return { season: t.easter, day: 'Easter Season', bg: 'bg-easter' };
            }
            
            return { season: t.ordinaryTime, day: 'Ordinary Time', bg: 'bg-ordinary' };
        }
        
        function isSameDay(date1, date2) {
            return date1.getDate() === date2.getDate() &&
                   date1.getMonth() === date2.getMonth() &&
                   date1.getFullYear() === date2.getFullYear();
        }
        
        // Sample Bible verses (would be fetched from Bible.com API in production)
           const sampleVerses = {
            en: [
                { title: 'John 3:16', text: 'For God so loved the world that he gave his one and only Son, that whoever believes in him shall not perish but have eternal life.', ref: 'John 3:16' },
                { title: 'Psalm 23:1', text: 'The Lord is my shepherd, I lack nothing.', ref: 'Psalm 23:1' },
                { title: 'Romans 8:28', text: 'And we know that in all things God works for the good of those who love him, who have been called according to his purpose.', ref: 'Romans 8:28' },
                { title: 'Philippians 4:13', text: 'I can do all this through him who gives me strength.', ref: 'Philippians 4:13' }
            ],
            fr: [
                { title: 'Jean 3:16', text: 'Car Dieu a tant aim√© le monde qu\'il a donn√© son Fils unique, afin que quiconque croit en lui ne p√©risse point, mais qu\'il ait la vie √©ternelle.', ref: 'Jean 3:16' },
                { title: 'Psaume 23:1', text: 'L\'√âternel est mon berger: je ne manquerai de rien.', ref: 'Psaume 23:1' },
                { title: 'Romains 8:28', text: 'Nous savons, du reste, que toutes choses concourent au bien de ceux qui aiment Dieu.', ref: 'Romains 8:28' },
                { title: 'Philippiens 4:13', text: 'Je puis tout par celui qui me fortifie.', ref: 'Philippiens 4:13' }
            ],
            es: [
                { title: 'Juan 3:16', text: 'Porque de tal manera am√≥ Dios al mundo, que ha dado a su Hijo unig√©nito, para que todo aquel que en √©l cree, no se pierda, mas tenga vida eterna.', ref: 'Juan 3:16' },
                { title: 'Salmo 23:1', text: 'Jehov√° es mi pastor; nada me faltar√°.', ref: 'Salmo 23:1' },
                { title: 'Romanos 8:28', text: 'Y sabemos que a los que aman a Dios, todas las cosas les ayudan a bien.', ref: 'Romanos 8:28' },
                { title: 'Filipenses 4:13', text: 'Todo lo puedo en Cristo que me fortalece.', ref: 'Filipenses 4:13' }
            ],
            pt: [
                { title: 'Jo√£o 3:16', text: 'Porque Deus amou o mundo de tal maneira que deu o seu Filho unig√™nito, para que todo aquele que nele cr√™ n√£o pere√ßa, mas tenha a vida eterna.', ref: 'Jo√£o 3:16' },
                { title: 'Salmo 23:1', text: 'O Senhor √© o meu pastor; nada me faltar√°.', ref: 'Salmo 23:1' },
                { title: 'Romanos 8:28', text: 'E sabemos que todas as coisas contribuem juntamente para o bem daqueles que amam a Deus.', ref: 'Romanos 8:28' },
                { title: 'Filipenses 4:13', text: 'Posso todas as coisas em Cristo que me fortalece.', ref: 'Filipenses 4:13' }
            ]
        };
        
        function getTodaysVerse() {
            const lang = config.language || 'en';
            const verses = sampleVerses[lang] || sampleVerses.en;
            const hour = new Date().getHours();
            const index = Math.floor(hour / 6) % verses.length;
            return verses[index];
        }

        // NEW: Modular feed priority system
       function getFeedForDateAndTime() {
       // Get current date/time
            const now = new Date();
            const dateStr = getCurrentDateString(); // Use existing helper
            const actualHour = now.getHours();
            const feedKey = `${dateStr}-${String(actualHour).padStart(2, '0')}`;
    
    // Load user settings
            const settings = JSON.parse(localStorage.getItem('userSettings')) || {
           liveEnabled: true,
           audioEnabled: true,
           prayerHours: [6, 12, 18, 21]
    };
    
    // PRIORITY 1: Prayer Notification (handled separately by checkPrayerTime)
    // Skip here, handled by separate function
    
    // PRIORITY 2: Live Feeds
    if (settings.liveEnabled && LIVE_FEEDS[feedKey] && isLiveAllowedNow()) {
        return {
            type: 'live',
            content: {
                url: LIVE_FEEDS[feedKey],
                title: 'Live Church Service'
            },
            audio: false
        };
    }
    
    // PRIORITY 3: Church Feeds (from external JSON)
    if (CHURCH_FEEDS[feedKey]) {
        return {
            type: 'church',
            content: CHURCH_FEEDS[feedKey],
            audio: settings.audioEnabled && isAudioAllowedNow()
        };
    }
    
    // PRIORITY 4: Liturgic Event Feeds (special days like Christmas, Easter)
    if (LITURGIC_EVENT_FEEDS[dateStr]) {
        return {
            type: 'liturgic',
            content: LITURGIC_EVENT_FEEDS[dateStr],
            audio: settings.audioEnabled && isAudioAllowedNow()
        };
    }
    
    // PRIORITY 5: Lectionary Feeds (daily readings based on liturgical calendar)
    if (LECTIONARY_FEEDS[dateStr]) {
        return {
            type: 'lectionary',
            content: LECTIONARY_FEEDS[dateStr],
            audio: settings.audioEnabled && isAudioAllowedNow()
        };
    }
    
    // PRIORITY 6: FALLBACK - Use your existing verse rotation system
    const verse = getTodaysVerse(); // ‚Üê THIS IS THE BRIDGE to your existing code
    return {
        type: 'default',
        content: verse, // verse already has .title, .text, .ref
        audio: settings.audioEnabled && isAudioAllowedNow()
    };
}

// Helper function: Check if live feeds allowed at this hour
        function isLiveAllowedNow() {
            const hour = new Date().getHours();
            const hourIndex = hour <= 12 ? hour : hour - 12; // Convert to 12h
            return !LIVE_FEED_RESTRICTIONS.restricted.includes(hourIndex);
}

// Helper function: Check if audio allowed at this hour
        function isAudioAllowedNow() {
        const hour = new Date().getHours();
        const hourIndex = hour <= 12 ? hour : hour - 12; // Convert to 12h
        return AUDIO_PERMISSIONS.allowed.includes(hourIndex);
}

// Helper function: Get date string (if you don't already have it)
        function getCurrentDateString() {
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const day = String(now.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}
        
 // Display functions
        function updateDateTime() {
    const now = new Date();
            
            // Date options (Saturday, February 14, 2026)
    const dateOptions = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric'
            };
            
            // Time options (11:07:25 AM)
    const timeOptions = {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            };
            
    const locale = config.language === 'en' ? 'en-US' : 
                          config.language === 'fr' ? 'fr-FR' :
                          config.language === 'es' ? 'es-ES' : 'pt-BR';
            
            document.getElementById('date-display').textContent = now.toLocaleDateString(locale, dateOptions);
            document.getElementById('time-display').textContent = now.toLocaleTimeString(locale, timeOptions);
        }
        
    function updateLiturgicalInfo() {
    const now = new Date();
    const info = getLiturgicalInfo(now);
            
            document.querySelector('.season-name').textContent = info.season;
            document.querySelector('.day-name').textContent = info.day;
            
    const display = document.getElementById('main-display');
            display.className = info.bg;
        }
        
       function updateDisplay() {
    // Use the new priority system
           const feedData = getFeedForDateAndTime();
    
    // Handle different feed types
    if (feedData.type === 'live') {
        // Show live stream banner
        const html = `
            <div style="background: linear-gradient(135deg, #ff3b30 0%, #ff9500 100%); 
                        color: white; padding: 40px; border-radius: 12px; text-align: center;">
                <h2 style="font-size: 32px; margin-bottom: 15px;">üî¥ LIVE NOW</h2>
                <p style="font-size: 20px; margin-bottom: 20px;">${feedData.content.title}</p>
                <a href="${feedData.content.url}" target="_blank" 
                   style="display: inline-block; background: white; color: #ff3b30; 
                          padding: 15px 30px; border-radius: 8px; text-decoration: none; 
                          font-weight: bold;">
                    Watch Service ‚Üí
                </a>
            </div>
        `;
        document.getElementById('verses').innerHTML = html;
        
    } else {
        // Show scripture verse (all other types)
        const verse = feedData.content;
        const html = `
            <div class="passage-title">${verse.title || verse.reference}</div>
            <div class="verse">${verse.text}</div>
            <div class="reference">${verse.ref || verse.reference}</div>
        `;
        document.getElementById('verses').innerHTML = html;
        
        // Play audio if enabled and allowed
        if (feedData.audio && shouldPlayAudio()) {
            const textToSpeak = `${verse.title || verse.reference}. ${verse.text}. ${verse.ref || verse.reference}`;
            speakText(textToSpeak);
        }
    }
}
       function shouldPlayAudio() {
            const hour = new Date().getHours();
            return (hour >= 6 && hour < 8) || (hour >= 17 && hour < 21);
        }
        
       function speakText(text) {
            if ('speechSynthesis' in window) {
                const indicator = document.getElementById('audio-indicator');
                indicator.style.display = 'block';
                indicator.classList.add('speaking');

                const utterance = new SpeechSynthesisUtterance(text);
                utterance.rate = 0.9;
                utterance.pitch = 1.0;
                utterance.volume = 1.0;
                
                // Set language based on config
                const langMap = {
                    'en': 'en-US',
                    'fr': 'fr-FR',
                    'es': 'es-ES',
                    'pt': 'pt-BR'
                };
                utterance.lang = langMap[config.language] || 'en-US';
                
                utterance.onend = function() {
                    indicator.style.display = 'none';
                    indicator.classList.remove('speaking');
                };

                window.speechSynthesis.cancel();
                setTimeout(function() {
                    window.speechSynthesis.speak(utterance);
                }, 100);
            }
        }
        
    function initializeDisplay() {
            updateDateTime();
            updateLiturgicalInfo();
            updateDisplay();
            
            setInterval(updateDateTime, 1000);
            setInterval(updateLiturgicalInfo, 60000);
            setInterval(updateDisplay, 6 * 60 * 60 * 1000);
            
            // Check for live streams every minute
            checkLiveStreams();
            setInterval(checkLiveStreams, 60000);
            
            // Attempt to prevent screen sleep
            preventScreenSleep();
            // Apply saved theme
            const settings = JSON.parse(localStorage.getItem('userSettings')) || {theme: 'auto'};
            applyTheme(settings.theme);

            // Re-apply theme every hour
            setInterval(() => {
            const settings = JSON.parse(localStorage.getItem('userSettings')) || {theme: 'auto'};
            applyTheme(settings.theme);
             }, 60000);
        }
         // NEW: Modular feed priority system
    function getFeedForDateAndTime() {
         // Get current date/time
            const now = new Date();
            const dateStr = getCurrentDateString(); // Use existing helper
            const actualHour = now.getHours();
            const feedKey = `${dateStr}-${String(actualHour).padStart(2, '0')}`;
    
         // Load user settings
            const settings = JSON.parse(localStorage.getItem('userSettings')) || {
            liveEnabled: true,
            audioEnabled: true,
            prayerHours: [6, 12, 18, 21]
    };
    
         // PRIORITY 1: Prayer Notification (handled separately by checkPrayerTime)
         // Skip here, handled by separate function
    
         // PRIORITY 2: Live Feeds
            if (settings.liveEnabled && LIVE_FEEDS[feedKey] && isLiveAllowedNow()) {
            return {
            type: 'live',
            content: {
                url: LIVE_FEEDS[feedKey],
                title: 'Live Church Service'
            },
            audio: false
        };
    }
    
        // PRIORITY 3: Church Feeds (from external JSON)
            if (CHURCH_FEEDS[feedKey]) {
            return {
            type: 'church',
            content: CHURCH_FEEDS[feedKey],
            audio: settings.audioEnabled && isAudioAllowedNow()
        };
    }
    
    // PRIORITY 4: Liturgic Event Feeds (special days like Christmas, Easter)
            if (LITURGIC_EVENT_FEEDS[dateStr]) {
            return {
            type: 'liturgic',
            content: LITURGIC_EVENT_FEEDS[dateStr],
            audio: settings.audioEnabled && isAudioAllowedNow()
        };
    }
    
    // PRIORITY 5: Lectionary Feeds (daily readings based on liturgical calendar)
            if (LECTIONARY_FEEDS[dateStr]) {
            return {
            type: 'lectionary',
            content: LECTIONARY_FEEDS[dateStr],
            audio: settings.audioEnabled && isAudioAllowedNow()
        };
    }
    
    // PRIORITY 6: FALLBACK - Use your existing verse rotation system
           const verse = getTodaysVerse(); // ‚Üê THIS IS THE BRIDGE to your existing code
           return {
           type: 'default',
           content: verse, // verse already has .title, .text, .ref
           audio: settings.audioEnabled && isAudioAllowedNow()
    };
}

    // Helper function: Check if live feeds allowed at this hour
          function isLiveAllowedNow() {
          const hour = new Date().getHours();
          const hourIndex = hour <= 12 ? hour : hour - 12; // Convert to 12h
          return !LIVE_FEED_RESTRICTIONS.restricted.includes(hourIndex);
}

// Helper function: Check if audio allowed at this hour
    function isAudioAllowedNow() {
    const hour = new Date().getHours();
    const hourIndex = hour <= 12 ? hour : hour - 12; // Convert to 12h
    return AUDIO_PERMISSIONS.allowed.includes(hourIndex);
}

// Helper function: Get date string (if you don't already have it)
    function getCurrentDateString() {
    const now = new Date();
    const year = now.getFullYear();
    const month = String(now.getMonth() + 1).padStart(2, '0');
    const day = String(now.getDate()).padStart(2, '0');
    return `${year}-${month}-${day}`;
}
    function preventScreenSleep() {
            // Method 1: Wake Lock API (modern browsers)
    if ('wakeLock' in navigator) {
                navigator.wakeLock.request('screen')
                    .then(wakeLock => {
                        console.log('Wake Lock enabled');
                        
                        // Re-acquire wake lock if page becomes visible again
                        document.addEventListener('visibilitychange', () => {
                            if (document.visibilityState === 'visible') {
                                navigator.wakeLock.request('screen');
                            }
                        });
                    })
                    .catch(err => {
                        console.log('Wake Lock not supported:', err);
                    });
            }
            
            // Method 2: NoSleep.js technique - play silent video
    const video = document.createElement('video');
            video.setAttribute('loop', '');
            video.setAttribute('muted', '');
            video.setAttribute('playsinline', '');
            video.style.display = 'none';
            
            // Tiny base64 encoded mp4 video (1 frame, silent)
            video.src = 'data:video/mp4;base64,AAAAIGZ0eXBpc29tAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAAAAhtZGF0AAAA1m1vb3YAAABsbXZoZAAAAAAAAAAAAAAAAAAAA+gAAAAAAAEAAAEAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAABidWR0YQAAAFptZXRhAAAAAAAAACFoZGxyAAAAAAAAAABtZGlyYXBwbAAAAAAAAAAAAAAAAC1pbHN0AAAAJal0b28AAAAdZGF0YQAAAAEAAAAATGF2ZjU4Ljc2LjEwMA==';
            
            document.body.appendChild(video);
            
            // Play video on any user interaction
    const startVideo = () => {
                video.play().catch(() => {});
                document.removeEventListener('click', startVideo);
                document.removeEventListener('touchstart', startVideo);
            };
            
            document.addEventListener('click', startVideo);
            document.addEventListener('touchstart', startVideo);
            
            // Auto-attempt after 1 second
            setTimeout(() => video.play().catch(() => {}), 1000);
            
            // Method 3: Periodic activity ping
            setInterval(() => {
                // Trigger a tiny layout recalc to keep browser active
                document.body.style.opacity = '0.9999';
                setTimeout(() => {
                    document.body.style.opacity = '1';
                }, 10);
            }, 30000); // Every 30 seconds
        }
        
        // Load saved config on startup
        window.addEventListener('load', function() {
            loadChurches();
            
    const saved = localStorage.getItem('bibleDisplayConfig');
            if (saved) {
                config = JSON.parse(saved);
                
                // Update UI to reflect saved settings
                document.querySelectorAll('.option-btn').forEach(btn => {
    const setting = btn.dataset.setting;
    const value = btn.dataset.value;
                    if (config[setting] === value) {
                        btn.classList.add('selected');
                    } else {
                        btn.classList.remove('selected');
                    }
                });
                
                // Set church selection
                setTimeout(() => {
    const select = document.getElementById('church-select');
                    if (select && config.church) {
                        select.value = config.church;
                    }
                }, 500);
            }
        });
        // Settings Panel Functions
    function openSettingsPanel() {
    // Load current settings
    loadCurrentSettings();
    document.getElementById('settings-panel').style.display = 'block';
}

    function closeSettingsPanel() {
    document.getElementById('settings-panel').style.display = 'none';
}

    function loadCurrentSettings() {
    // Load from localStorage
    const settings = JSON.parse(localStorage.getItem('userSettings')) || {
        audioEnabled: true,
        liveEnabled: true,
        theme: 'auto',
        prayerHours: [6, 12, 18, 21]
    };
    
    document.getElementById('audio-toggle').checked = settings.audioEnabled;
    document.getElementById('live-toggle').checked = settings.liveEnabled;
    document.getElementById('theme-select').value = settings.theme;
    
    // Set prayer hour checkboxes
    document.querySelectorAll('.prayer-hour').forEach(checkbox => {
        checkbox.checked = settings.prayerHours.includes(parseInt(checkbox.value));
    });
}

    function saveSettings() {
    const prayerHours = [];
    document.querySelectorAll('.prayer-hour:checked').forEach(checkbox => {
        prayerHours.push(parseInt(checkbox.value));
    });
    
    const settings = {
        audioEnabled: document.getElementById('audio-toggle').checked,
        liveEnabled: document.getElementById('live-toggle').checked,
        theme: document.getElementById('theme-select').value,
        prayerHours: prayerHours
    };
    
    localStorage.setItem('userSettings', JSON.stringify(settings));
    
    // Apply theme immediately
    applyTheme(settings.theme);
    
    closeSettingsPanel();
    
    // Refresh display with new settings
    updateDisplay();
}

    function applyTheme(theme) {
    const body = document.getElementById('main-display');
    const hour = new Date().getHours();
    
    if (theme === 'auto') {
        // Auto dark mode 8 PM - 6 AM
        if (hour >= 20 || hour < 6) {
            body.classList.add('dark-theme');
        } else {
            body.classList.remove('dark-theme');
        }
    } else if (theme === 'dark') {
        body.classList.add('dark-theme');
    } else {
        body.classList.remove('dark-theme');
    }
    function checkPrayerTime() {
    const settings = JSON.parse(localStorage.getItem('userSettings')) || {prayerHours: []};
    const now = new Date();
    const hour = now.getHours();
    const minute = now.getMinutes();
    
    // Show notification 2 minutes before prayer hour
    if (minute === 58 && settings.prayerHours.includes(hour + 1)) {
        showPrayerNotification();
    }
}

    function showPrayerNotification() {
    const lang = config.language || 'en';
    const messages = {
        en: "A day in His presence is worth a thousand elsewhere. We will pray in two minutes.",
        fr: "Un jour dans sa pr√©sence vaut mille ailleurs. Nous allons prier dans deux minutes."
    };
    
    document.getElementById('prayer-message').textContent = messages[lang];
    document.getElementById('prayer-notification').style.display = 'block';
    
    // Play audio notification
    if ('speechSynthesis' in window) {
        const utterance = new SpeechSynthesisUtterance(messages[lang]);
        utterance.lang = lang === 'fr' ? 'fr-FR' : 'en-US';
        window.speechSynthesis.speak(utterance);
    }
    
    // Hide after 2 minutes
    setTimeout(() => {
        document.getElementById('prayer-notification').style.display = 'none';
    }, 120000);
}

// Check every 30 seconds
setInterval(checkPrayerTime, 30000);

    </script>
</body>
</html>
